<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generator Eventów AoH3</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #1e1e1e;
            color: #ffffff;
        }

        .container {
            background: #2d2d2d;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
        }

        h1 {
            color: #4caf50;
            text-align: center;
        }

        .section {
            margin-bottom: 30px;
            border: 1px solid #444;
            padding: 15px;
            border-radius: 5px;
        }

        .error {
            color: #ff4444;
            font-size: 0.9em;
            display: none;
        }

        input, select, textarea {
            width: 100%;
            padding: 8px;
            margin: 5px 0;
            border: 1px solid #444;
            border-radius: 4px;
            background-color: #3d3d3d;
            color: #ffffff;
        }

        button {
            background-color: #4caf50;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }

        button.remove-btn {
            background-color: #ff4444;
        }

        button:hover {
            opacity: 0.9;
        }

        .links {
            margin-top: 20px;
            padding: 15px;
            background: #3d3d3d;
            border-radius: 5px;
        }

        .links a {
            display: block;
            margin: 5px 0;
            color: #4caf50;
            text-decoration: none;
        }

        #output {
            white-space: pre-wrap;
            background: #3d3d3d;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
            color: #ffffff;
        }

        .trigger, .option, .outcome {
            margin-bottom: 10px;
            padding: 10px;
            border: 1px solid #444;
            border-radius: 5px;
            background-color: #3d3d3d;
        }

        .checkbox-group {
            margin: 15px 0;
            display: flex;
            gap: 20px;
        }

        .checkbox-group label {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
        }

        .checkbox-group input[type="checkbox"] {
            width: 16px;
            height: 16px;
            margin: 0;
            cursor: pointer;
            accent-color: #4caf50;
        }

        #mission-image-group {
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Generator Eventów - Age of History 3</h1>
        
        <div class="links">
            <h3>Przydatne linki:</h3>
            <a href="http://www.ageofcivilizationsgame.com/topic/248695-age-of-history-3-events-triggers/" target="_blank">Lista wszystkich triggerów</a>
            <a href="http://www.ageofcivilizationsgame.com/topic/249748-age-of-history-3-how-to-add-an-event/" target="_blank">Jak dodać event</a>
            <a href="http://www.ageofcivilizationsgame.com/topic/248694-age-of-history-3-events-outcomes/" target="_blank">Lista wszystkich efektów</a>
        </div>

        <div class="section">
            <h2>Podstawowe informacje</h2>
            <input type="text" id="event-id" placeholder="ID eventu (np. unique_event_123)">
            <input type="text" id="event-title" placeholder="Tytuł eventu">
            <textarea id="event-desc" placeholder="Opis eventu" rows="3"></textarea>
            <input type="text" id="event-image" placeholder="Ścieżka do obrazka (np. event1.png)">
            
            <div class="checkbox-group">
                <label>
                    <input type="checkbox" id="show-in-missions" onchange="toggleMissionImage()">
                    <span>Pokaż w misjach</span>
                </label>
                <label>
                    <input type="checkbox" id="only-once" checked>
                    <span>Tylko raz</span>
                </label>
            </div>
            
            <div id="mission-image-group">
                <input type="text" id="mission-image" placeholder="Numer obrazka misji (np. 2)">
            </div>
        </div>

        <div class="section">
            <h2>Warunki wyzwalające (Triggery)
                <button type="button" onclick="addTrigger()">+ Dodaj trigger</button>
            </h2>
            <div id="triggers-container"></div>
        </div>

        <div class="section">
            <h2>Opcje / Przyciski
                <button type="button" onclick="addOption()">+ Dodaj opcję / przycisk</button>
            </h2>
            <div id="options-container"></div>
        </div>

        <div id="error-message" class="error"></div>
        <button onclick="generateEvent()" style="background-color: #4caf50">Generuj Event</button>
        
        <div id="output"></div>
    </div>

    <script>
        const triggersList = [
            "civ_regiments_over", "civ_gold_over", "civ_population_over", "civ_provinces_over",
            "civ_is_at_war", "civ_has_resource", "civ_religion_is", "civ_government_is",
            "civ_has_more_provinces_than_civ", "civs_are_neighbors", "civs_are_at_war",
            "civs_have_alliance", "province_controlled_by", "province_is_occupied",
            "province_is_under_siege", "province_religion_is", "province_unrest_over",
            "province_population_over", "is_civ", "declare_war2", "has_variable",
            "random_chance", "year_over", "year_below", "exact_day", "playing_time_over",
            "playing_time_below", "civ_has_larger_population_than_civ", "civ_has_larger_economy_than_civ",
            "civ_has_more_regiments_than_civ", "civ_has_higher_ranking_than_civ", "civ_has_more_technologies_than_civ",
            "civs_opinion_over", "civs_opinion_below", "civs_are_rivals", "civ_has_rivalry",
            "civ_has_rivalry_not", "civs_have_defensive_pact", "civs_have_non_aggression",
            "civs_have_truce", "civ_have_military_access", "civ_have_guarantee"
        ];

        const outcomesList = [
            "gold", "prestige", "legacy", "manpower", "max_morale", "army_morale_recovery",
            "tax_efficiency", "research_points", "inflation", "unrest", "province_manpower",
            "province_economy", "province_growth_rate", "province_tax_efficiency", "province_unrest",
            "province_infrastructure", "province_defense_lvl", "province_buildings", "province_buildings_limit",
            "province_is_capital", "province_is_occupied", "province_is_under_siege", "province_religion_is",
            "province_religion_is_not", "province_has_building", "province_controlled_by", "province_not_controlled_by",
            "province_civ_has_core"
        ];

        let triggerCount = 0;
        let optionCount = 0;

        function toggleMissionImage() {
            const missionImageGroup = document.getElementById('mission-image-group');
            missionImageGroup.style.display = document.getElementById('show-in-missions').checked ? 'block' : 'none';
        }

        function addTrigger() {
            const container = document.getElementById('triggers-container');
            const div = document.createElement('div');
            div.className = 'trigger';
            div.innerHTML = `
                <select class="trigger-select">
                    <option value="">Wybierz trigger...</option>
                    ${triggersList.map(trigger => `<option value="${trigger}">${trigger}</option>`).join('')}
                </select>
                <input type="text" placeholder="Wartość (np. 10 lub spa=ger)">
                <button class="remove-btn" onclick="this.parentElement.remove()">Usuń</button>
            `;
            container.appendChild(div);
        }

        function addOption() {
            const container = document.getElementById('options-container');
            const div = document.createElement('div');
            div.className = 'option';
            div.innerHTML = `
                <h3>Opcja ${++optionCount}</h3>
                <input type="text" placeholder="Nazwa przycisku">
                <input type="number" placeholder="AI probability (np. 50)">
                
                <div class="outcomes">
                    <h4>Efekty:</h4>
                    <button type="button" onclick="addOutcome(this)">+ Dodaj efekt</button>
                </div>
                <button class="remove-btn" onclick="this.parentElement.remove()">Usuń opcję / przycisk</button>
            `;
            container.appendChild(div);
        }

        function addOutcome(button) {
            const outcomesDiv = button.previousElementSibling;
            const div = document.createElement('div');
            div.className = 'outcome';
            div.innerHTML = `
                <select>
                    <option value="">Wybierz efekt...</option>
                    ${outcomesList.map(outcome => `<option value="${outcome}">${outcome}</option>`).join('')}
                </select>
                <input type="text" placeholder="Wartość (np. 100 lub ger=fra)">
                <button class="remove-btn" onclick="this.parentElement.remove()">Usuń</button>
            `;
            outcomesDiv.appendChild(div);
        }

        function validateFields() {
            const errors = [];
            
            if(!document.getElementById('event-id').value) errors.push("ID eventu jest wymagane!");
            if(!document.getElementById('event-title').value) errors.push("Tytuł eventu jest wymagany!");
            if(!document.getElementById('event-desc').value) errors.push("Opis eventu jest wymagany!");
            
            if(document.getElementById('show-in-missions').checked && !document.getElementById('mission-image').value) {
                errors.push("Wymagane jest podanie obrazka misji!");
            }

            const triggers = document.querySelectorAll('.trigger');
            if(triggers.length === 0) errors.push("Dodaj przynajmniej jeden trigger!");
            
            triggers.forEach(trigger => {
                const select = trigger.querySelector('select');
                const input = trigger.querySelector('input');
                if(!select.value || !input.value) errors.push("Niekompletny trigger!");
            });

            const options = document.querySelectorAll('.option');
            if(options.length === 0) errors.push("Dodaj przynajmniej jedną opcję!");
            
            options.forEach(option => {
                if(!option.querySelector('input[type="text"]').value) errors.push("Brak nazwy dla opcji!");
                if(!option.querySelector('input[type="number"]').value) errors.push("Brak wartości AI dla opcji!");
                
                const outcomes = option.querySelectorAll('.outcome');
                if(outcomes.length === 0) errors.push("Dodaj przynajmniej jeden efekt do opcji!");
            });

            return errors;
        }

        function generateEvent() {
            const errors = validateFields();
            const errorDiv = document.getElementById('error-message');
            
            if(errors.length > 0) {
                errorDiv.innerHTML = errors.join('<br>');
                errorDiv.style.display = 'block';
                return;
            }
            
            errorDiv.style.display = 'none';

            let eventCode = `id=${document.getElementById('event-id').value}\n`;
            eventCode += `title=${document.getElementById('event-title').value}\n`;
            eventCode += `desc=${document.getElementById('event-desc').value}\n`;
            
            if(document.getElementById('event-image').value) {
                eventCode += `image=${document.getElementById('event-image').value}\n`;
            }

            // Zawsze dodajemy show_in_missions
            eventCode += `show_in_missions=${document.getElementById('show-in-missions').checked}\n`;
            
            if(document.getElementById('show-in-missions').checked) {
                eventCode += `mission_image=${document.getElementById('mission-image').value}\n`;
            }

            // Zawsze dodajemy only_once
            eventCode += `only_once=${document.getElementById('only-once').checked}\n`;

            eventCode += '\ntrigger_and\n';
            document.querySelectorAll('.trigger').forEach(trigger => {
                eventCode += `next_and\n${trigger.querySelector('select').value}=${trigger.querySelector('input').value}\n`;
            });
            eventCode += 'trigger_and_end\n\n';

            document.querySelectorAll('.option').forEach(option => {
                eventCode += 'option_btn\n';
                eventCode += `name=${option.querySelector('input[type="text"]').value}\n`;
                eventCode += `ai=${option.querySelector('input[type="number"]').value}\n`;
                
                option.querySelectorAll('.outcome').forEach(outcome => {
                    const select = outcome.querySelector('select');
                    const input = outcome.querySelector('input');
                    eventCode += `${select.value}=${input.value}\n`;
                });
                
                eventCode += 'option_end\n\n';
            });

            document.getElementById('output').textContent = eventCode;
        }
    </script>
</body>
</html>